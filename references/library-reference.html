


<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Python Library Reference - Bonsai</title>
    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">WebFont.load({  google: {    families: ["Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic"]  }});</script>
    <link href="../stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" media="print" />
	  <link href="../stylesheets/test.css" rel="stylesheet" media="screen" />
    <link href="../favicon.ico" rel="icon" type="image/ico" />
      <script src="../javascripts/all.js"></script>
      <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WVB6MG2');</script>
<!-- End Google Tag Manager -->
      <!-- start Mixpanel -->
<script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
mixpanel.init("91fbf7b68fb2356f91916026f221ddd5", {
    loaded: function(mixpanel) {
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        distinct_id = getParameterByName('refUserId');
        if (distinct_id) {
          mixpanel.identify(distinct_id);
        }
    }
});</script>
<!-- end Mixpanel -->

  </head>

  <body class="references references_library-reference" data-languages="[]">


	  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WVB6MG2"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --> 

  <div id="flex-container">

	<nav id="primary-nav">



	<div id="logo"> <a href="../"><img class="bonsai-logo" src="../images/bonsai-logo.svg"></a></div>

	<label for="drop" class="toggle"><img class="menu-ham" src="../images/menu.svg"></label>
	<input type="checkbox" id="drop" />

	<ul class="menu">

		<li class="header_menu_item "> <a href="../guides/getting-started.html">Quick Start</a></li>

		<li class="header_menu_item"> <!-- First Tier Drop Down --> <label for="drop-1" class="toggle">Tutorials +</label><a  href="#">Tutorials</a>
			<input type="checkbox" id="drop-1"/>
			<ul id="tutorials">
				<li class=""> <a href="../guides/cli-install-guide.html">Install the CLI</a>  </li>
				<li class=""> <a href="../guides/local-dev-guide.html">Use the CLI for Training</a>  </li>
				<li class=""> <a href="../guides/sdk-install-guide.html">Install the SDK</a>  </li>
				<li class=""> <a href="../tutorials/tutorial1.html">Running Simulations and Writing Inkling</a>  </li>
				<li class=""> <a href="../tutorials/simulink.html">Train a Simulink Model with Bonsai</a>  </li>
				<li class=""> <a href="../guides/jupyter-api-guide.html">Use Bonsai's API with Jupyter</a>  </li>
			</ul>
		</li>

		<li class="header_menu_item"> <!-- First Tier Drop Down --> <label for="drop-2" class="toggle">Guides +</label><a  href="#">Guides</a>
			<input type="checkbox" id="drop-2"/>
			<ul id="guides">
				<li class=""> <a href="../guides/simulation-guide.html">Learn About Simulation Requirements</a>  </li>
				<li class=""> <a href="../guides/inkling-guide.html">Learn the Inkling Language</a>  </li>
				<li class=""> <a href="../guides/machine-teaching.html">Programming Machine Teaching</a>  </li>
				<li class=""> <a href="../guides/ai-engine-guide.html">Understand AI Engine Components</a>  </li>
				<li class=""> <a href="../guides/web-graphs-guide.html">Understand BRAIN Graphs</a>  </li>
			</ul>
		</li>

		<li class="header_menu_item"> <!-- First Tier Drop Down --> <label for="drop-3" class="toggle">References +</label><a  href="#">References</a>
			<input type="checkbox" id="drop-3"/>
			<ul id="references">
				<li class=""> <a href="api-reference.html">API Reference</a>  </li>
				<li class=""> <a href="cli-reference.html">CLI Reference</a>  </li>
				<li class=""> <a href="inkling-reference.html">Inkling Reference</a>  </li>
				<li class=""> <a href="simulator-reference.html">Simulator Reference</a>
				<li class="selected"> <a href="library-reference.html">Python Library</a>  </li>
				<li class=""> <a href="cpp-library-reference.html">C++ Library</a>  </li>
				
			</ul> 
		</li>

		<li class="header_menu_item "> <a href="../examples.html">Examples</a></li>

		<li>
			<input type="search" id="docs-search" placeholder="Search Bonsai Docs">
		</li>


	</ul>

</nav>


	<div id="main-wrapper">

    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">

        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div class="page-title">Python Library Reference</div>
      <div id="toc">
      </div>

			 
<ul class="toc-footer">

<li><a href='https://bons.ai'>Bonsai Home</a></li>
<li><a href='https://beta.bons.ai'>BRAIN Dashboard</a></li>
<li><a href='https://github.com/BonsaiAI/slate'>Contribute to the Docs</a></li>
<li><a href='https://bons.ai/get-started'>Apply for Bonsai Platform Preview</a></li>
<li><a href="/releases.html">Product Release Notes</a></li>
<li><a href="/system-reqs.html">Official System Requirements</a></li>
<li><a href='https://bons.ai/contact-us#contact-page-form'>Contact Us</a></li>

</ul>


	   <div class="cc-bottom">
	
	<div class="toc-footer bottom cc-info">

		<a href='https://creativecommons.org/licenses/by-sa/4.0/' class="cc-icon-width" >
			<svg class="cc" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
			viewBox="0 0 70.7 13.4" style="enable-background:new 0 0 70.7 13.4;" xml:space="preserve">

				<g>

				<g>
				<circle class="st0" cx="6.8" cy="6.7" r="6.1"/>
				<path d="M6.7,0c1.9,0,3.5,0.7,4.8,2c0.6,0.6,1.1,1.4,1.4,2.2c0.3,0.8,0.5,1.7,0.5,2.6c0,0.9-0.2,1.8-0.5,2.6
				c-0.3,0.8-0.8,1.5-1.4,2.1c-0.7,0.6-1.4,1.1-2.2,1.5c-0.8,0.3-1.7,0.5-2.6,0.5S5,13.3,4.2,12.9c-0.8-0.3-1.5-0.8-2.2-1.5
				s-1.1-1.4-1.5-2.2S0,7.6,0,6.7C0,5.8,0.2,5,0.5,4.2S1.3,2.6,2,2C3.3,0.7,4.8,0,6.7,0z M6.7,1.2c-1.5,0-2.8,0.5-3.9,1.6
				C2.3,3.4,1.9,4,1.6,4.6C1.4,5.3,1.2,6,1.2,6.7c0,0.7,0.1,1.4,0.4,2.1c0.3,0.7,0.7,1.3,1.2,1.8c0.5,0.5,1.1,0.9,1.8,1.2
				c0.7,0.3,1.4,0.4,2.1,0.4c0.7,0,1.4-0.1,2.1-0.4c0.7-0.3,1.3-0.7,1.8-1.2c1-1,1.6-2.3,1.6-3.9c0-0.7-0.1-1.4-0.4-2.1
				c-0.3-0.7-0.7-1.3-1.2-1.8C9.5,1.8,8.2,1.2,6.7,1.2z M6.6,5.6L5.7,6.1C5.6,5.9,5.5,5.7,5.4,5.6C5.3,5.6,5.1,5.5,5,5.5
				c-0.6,0-0.9,0.4-0.9,1.2c0,0.4,0.1,0.6,0.2,0.9C4.5,7.8,4.7,7.9,5,7.9c0.4,0,0.7-0.2,0.8-0.6l0.8,0.4C6.5,8.1,6.2,8.3,5.9,8.5
				c-0.3,0.2-0.7,0.3-1,0.3c-0.6,0-1.1-0.2-1.5-0.6C3.1,7.9,2.9,7.4,2.9,6.7c0-0.6,0.2-1.1,0.6-1.5c0.4-0.4,0.8-0.6,1.4-0.6
				C5.7,4.6,6.3,5,6.6,5.6z M10.5,5.6L9.6,6.1C9.5,5.9,9.4,5.7,9.3,5.6C9.1,5.6,9,5.5,8.9,5.5C8.3,5.5,8,5.9,8,6.7
				c0,0.4,0.1,0.6,0.2,0.9c0.2,0.2,0.4,0.3,0.7,0.3c0.4,0,0.7-0.2,0.8-0.6l0.8,0.4c-0.2,0.3-0.4,0.6-0.7,0.8c-0.3,0.2-0.7,0.3-1,0.3
				c-0.6,0-1.1-0.2-1.5-0.6C7,7.9,6.8,7.4,6.8,6.7c0-0.6,0.2-1.1,0.6-1.5c0.4-0.4,0.8-0.6,1.4-0.6C9.6,4.6,10.2,5,10.5,5.6z"/>
				</g>

				</g>
			</svg>
		</a>
		
		<a href='https://creativecommons.org/licenses/by-sa/4.0/'>Content:
		CC-BY-SA </a>
		
	</div>

</div>

    </div>

    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="library-overview">Library Overview</h1>

<p>The Bonsai libraries known as <code class="prettyprint">libbonsai</code> (C++) and <code class="prettyprint">bonsai_ai</code> (Python) wrap the Bonsai API to simplify the process of building simulators in C++ and Python programming languages. This Python library is compatible with Python 2.7+ and Python 3+ on Windows 7/10, macOS, and Linux.</p>

<p>When the AI Engine trains with the simulator it works in a loop. First, the simulator connects and registers itself with the AI Engine. Then, the simulator sends the AI Engine a state and the value of any objectives or rewards; next, the AI Engine replies with an action. The simulator then uses this action to advance the simulation and compute a new state. This “send state, receive action” process is repeated until training stops. At any time the AI engine may stop, reconfigure, and reset the simulator. After doing so it will either restart this training loop or stop training. A single state, action, next state, loop is sometimes referred to as an “iteration”.</p>

<p>The <code class="prettyprint">Config</code> object has a built in command line parser which can be used to override the local running environment. It comes with a set of standard switches which can be viewed with the <code class="prettyprint">--help</code> option. The current default configuration is read from environment variables, a <code class="prettyprint">~/.bonsai</code> configuration file in the user’s home directory, a <code class="prettyprint">./.bonsai</code> and a <code class="prettyprint">./.brains</code> configuration file in the current working directory, command line options, and programmatically in code.</p>

          <h1 id="brain-class">Brain Class</h1>

<p>Manages a BRAIN instance, talks with the server backend, and contains
information about the BRAIN state. In future versions will be used to upload
and download Inkling to and from the BRAIN on the server.</p>

<p>Requires a configuration and a BRAIN name. The BRAIN name can be set in
several places, and there is an order of what takes precedence over the other as follows:</p>

<p>Brain() &gt;&gt; &ndash;brain &gt;&gt; .brains &gt;&gt; .bonsai[profile] &gt;&gt; .bonsai[DEFAULT] &gt;&gt; env[BONSAI_TRAIN_BRAIN]</p>

<p>such that &ldquo;&gt;&gt;&rdquo; indicates a decreasing order of precedence. Note that failure to set
BRAIN name in at least one of these places will result in a friendly error.</p>

<h2 id="brain-config-name">Brain(config, name)</h2>
<pre class="highlight python tab-python"><code><span class="n">config</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="n">brain</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Brain</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">brain</span><span class="p">)</span>
</code></pre>
<p>Creates a local object for interacting with an existing BRAIN on the server.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">config</code></td>
<td>Object returned by previously created <code class="prettyprint">bonsai_ai.Config</code>.</td>
</tr>
<tr>
<td><code class="prettyprint">name</code></td>
<td>BRAIN name as specified on the server. If name is empty, the BRAIN name in <code class="prettyprint">config</code> is used instead.</td>
</tr>
</tbody></table>

<h2 id="update">update()</h2>
<pre class="highlight python tab-python"><code><span class="n">brain</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</code></pre>
<p>Refreshes description, status, and other information with the current state of the BRAIN on the server.
Called by default when constructing a new Brain object.</p>

<h2 id="name">name</h2>
<pre class="highlight python tab-python"><code><span class="k">print</span><span class="p">(</span><span class="n">brain</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre>
<p>Returns the name of the BRAIN as specified when it was created.</p>

<h2 id="description">description</h2>
<pre class="highlight python tab-python"><code><span class="k">print</span><span class="p">(</span><span class="n">brain</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</code></pre>
<p>Returns the user-provided description for the BRAIN.</p>

<h2 id="version">version</h2>
<pre class="highlight python tab-python"><code><span class="k">print</span><span class="p">(</span><span class="n">brain</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
</code></pre>
<p>Returns the current version number of the BRAIN.</p>

<h2 id="latest_version">latest_version</h2>
<pre class="highlight python tab-python"><code><span class="k">print</span><span class="p">(</span><span class="n">brain</span><span class="o">.</span><span class="n">latest_version</span><span class="p">)</span>
</code></pre>
<p>Returns latest version number of the BRAIN.</p>

<h2 id="config-config">Config config</h2>
<pre class="highlight python tab-python"><code><span class="k">print</span><span class="p">(</span><span class="n">brain</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
</code></pre>
<p>Returns the configuration used to locate this BRAIN.</p>

          <h1 id="config-class">Config Class</h1>

<blockquote>
<p>Example <code class="prettyprint">~/.bonsai</code> file</p>
</blockquote>
<pre class="highlight ini tab-ini"><code><span class="nn">[DEFAULT]</span>
<span class="py">username</span> <span class="p">=</span> <span class="s">admin</span>
<span class="py">accesskey</span> <span class="p">=</span> <span class="s">None</span>
<span class="py">profile</span> <span class="p">=</span> <span class="s">dev</span>

<span class="nn">[dev]</span>
<span class="py">url</span> <span class="p">=</span> <span class="s">http://localhost:5000</span>
<span class="py">username</span> <span class="p">=</span> <span class="s">admin</span>
<span class="py">accesskey</span> <span class="p">=</span> <span class="s">00000000-1111-2222-3333-000000000001</span>
</code></pre>
<p>Manages Bonsai configuration environments.
Config files can be specified in the user home directory, <code class="prettyprint">~/.bonsai</code>,
or in a local directory. Configuration parameters can also be parsed from
the command line.</p>

<p>The <code class="prettyprint">profile</code> key can be used to switch between different profiles in
one configuration file.</p>

<h2 id="config-profile">Config(profile)</h2>
<pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">bonsai_ai</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Config</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre>
<p>Constructs a default configuration.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">profile</code></td>
<td>Optional <code class="prettyprint">.bonsai</code> profile name. Will use the DEFAULT profile if not specified.</td>
</tr>
</tbody></table>

<p>Configurations are stored in <code class="prettyprint">~/.bonsai</code> and <code class="prettyprint">./.bonsai</code> configuration files.
The local configuration file overrides settings in the configuration file in the user home directory.</p>

<h2 id="config-argv-profile">Config(argv, profile)</h2>
<pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">bonsai_ai</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre>
<p>Constructs a config by looking in the configuration files and parsing the command line arguments.
To see the list of command line arguments, pass in the <code class="prettyprint">--help</code> flag.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">argv</code></td>
<td>As passed to main().</td>
</tr>
<tr>
<td><code class="prettyprint">profile</code></td>
<td>Optional <code class="prettyprint">.bonsai</code> profile name. Will use the DEFAULT profile if not specified.</td>
</tr>
</tbody></table>

<p>Unrecognized arguments will be ignored.</p>

<h2 id="accesskey">accesskey</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">accesskey</span> <span class="o">==</span> <span class="s">'00000000-1111-2222-3333-000000000001'</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">accesskey</span> <span class="o">=</span> <span class="s">'00000000-1111-2222-3333-000000000001'</span>
</code></pre>
<p>Server authentication token.
Obtained from the bonsai server. You need to set it in your config.</p>

<h2 id="username">username</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="s">'alice'</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">'alice'</span>
</code></pre>
<p>Account user name.
The account you signed up with.</p>

<h2 id="url">url</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">url</span> <span class="o">==</span> <span class="s">'https://api.bons.ai'</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s">'https://api.bons.ai'</span>
</code></pre>
<p>Server URL.
Address and port number of the bonsai server. Normally you should not need to change this.</p>

<h2 id="proxy">proxy</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">proxy</span> <span class="o">==</span> <span class="s">'myproxy:5000'</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">proxy</span> <span class="o">=</span> <span class="s">'myproxy:5000'</span>
</code></pre>
<p>Proxy Server.
Address and port number of the proxy server to connect through.</p>

<h2 id="brain">brain</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">brain</span> <span class="o">==</span> <span class="s">'scarecrow'</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">brain</span> <span class="o">=</span> <span class="s">'scarecrow'</span>
</code></pre>
<p>BRAIN name.
Name of the BRAIN on the server.</p>

<h2 id="predict">predict</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">predict</span> <span class="o">==</span> <span class="bp">True</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">brain</span> <span class="o">=</span> <span class="bp">True</span>
</code></pre>
<p>Simulator mode.
The mode in which simulators will run. True if running for prediction, false for training.</p>

<h2 id="brain_version">brain_version</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">brain_version</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">brain_version</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre>
<p>BRAIN version.
The version of the brain to use when running for prediction. Set to 0 to use latest version.</p>

<h2 id="record_file">record_file</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">record_file</span> <span class="o">==</span> <span class="s">"foobar.json"</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">record_file</span> <span class="o">=</span> <span class="s">"foobar.json"</span>
</code></pre>
<p>This property defines the destination for log recording. Additionally, the format for log recording is inferred from the file extension. Currently supported options are <code class="prettyprint">json</code> and <code class="prettyprint">csv</code>. Missing file extension or use of an unsupported extension will result in runtime errors.</p>

<h2 id="record_enabled">record_enabled</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">record_enabled</span> <span class="o">==</span> <span class="bp">True</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">record_enabled</span> <span class="o">=</span> <span class="bp">True</span>
</code></pre>
<h2 id="record_format">record_format</h2>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">record_file</span> <span class="o">==</span> <span class="s">"foobar.json"</span>
<span class="n">my_config</span><span class="o">.</span><span class="n">record_format</span> <span class="o">==</span> <span class="s">"json"</span><span class="p">;</span>
</code></pre>
<p><strong>Note:</strong> This property cannot be set directly. It reflects the file extension of the currently configured <code class="prettyprint">record_file</code>. <code class="prettyprint">json</code> or <code class="prettyprint">csv</code> are valid.</p>

          <h1 id="simulator-class">Simulator Class</h1>

<blockquote>
<p><img src="../images/simulator_state.svg" alt="Simulator state image" /></p>
</blockquote>

<p>This class is used to interface with the server while training or running predictions against
a <strong>BRAIN</strong>. It is an abstract base class, and to use it a developer must create a subclass.</p>

<p>The <code class="prettyprint">Simulator</code> class is closely related to the <strong>Inkling</strong> file that is associated with
the <strong>BRAIN</strong>. The name used to construct <code class="prettyprint">Simulator</code> must match the name of the simulator
in the <em>Inkling</em> file.</p>

<p>There are two main methods that you must override, <code class="prettyprint">episode_start</code> and <code class="prettyprint">simulate</code>. The diagram
demonstrates how these are called during training. Optionally, one may also override
<code class="prettyprint">episode_finish</code>, which is called at the end of an episode.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">brain</code></td>
<td>The simulator&rsquo;s Brain object.</td>
</tr>
<tr>
<td><code class="prettyprint">name</code></td>
<td>The simulator&rsquo;s name.</td>
</tr>
<tr>
<td><code class="prettyprint">objective_name</code></td>
<td>The name of the current objective for an episode.</td>
</tr>
<tr>
<td><code class="prettyprint">episode_reward</code></td>
<td>Cumulative reward for this episode so far.</td>
</tr>
<tr>
<td><code class="prettyprint">episode_count</code></td>
<td>Number of completed episodes since sim launch.</td>
</tr>
<tr>
<td><code class="prettyprint">episode_rate</code></td>
<td>Episodes per second.</td>
</tr>
<tr>
<td><code class="prettyprint">iteration_count</code></td>
<td>Number of iterations for the current episode.</td>
</tr>
<tr>
<td><code class="prettyprint">iteration_rate</code></td>
<td>Iterations per second.</td>
</tr>
</tbody></table>

<h2 id="simulator-brain-name">Simulator(brain, name)</h2>

<blockquote>
<p>Example Inkling:</p>
</blockquote>
<pre class="highlight inkling tab-inkling"><code><span class="k">simulator</span> <span class="nx">my_simulator</span><span class="p">(</span><span class="nx">Config</span><span class="p">)</span>
    <span class="k">action</span> <span class="p">(</span><span class="nx">Action</span><span class="p">)</span>
    <span class="k">state</span> <span class="p">(</span><span class="nx">State</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>
<blockquote>
<p>Example code:</p>
</blockquote>
<pre class="highlight python tab-python"><code><span class="k">class</span> <span class="nc">MySimulator</span><span class="p">(</span><span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Simulator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">brain</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">brain</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="c"># your sim init code goes here.</span>

    <span class="k">def</span> <span class="nf">episode_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># your reset/init code goes here.</span>
        <span class="k">return</span> <span class="n">my_state</span>

    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="c"># your simulation stepping code goes here.</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">my_state</span><span class="p">,</span> <span class="n">my_reward</span><span class="p">,</span> <span class="n">is_terminal</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">episode_finish</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># your post episode code goes here.</span>
        <span class="k">pass</span>

<span class="o">...</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="n">brain</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Brain</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">MySimulator</span><span class="p">(</span><span class="n">brain</span><span class="p">,</span> <span class="s">"my_simulator"</span><span class="p">)</span>

<span class="o">...</span>
</code></pre>
<p>Serves as a base class for running simulations. You should create a subclass
of Simulator and implement the <code class="prettyprint">episode_start</code> and <code class="prettyprint">simulate</code> callbacks.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">brain</code></td>
<td>A Brain object for the BRAIN you wish to train against.</td>
</tr>
<tr>
<td><code class="prettyprint">name</code></td>
<td>The name of simulator as specified in the Inkling for the BRAIN.</td>
</tr>
</tbody></table>

<h2 id="brain-brain">Brain brain</h2>
<pre class="highlight python tab-python"><code><span class="k">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">brain</span><span class="p">)</span>
</code></pre>
<p>Returns the BRAIN being used for this simulation.</p>

<h2 id="name">name</h2>
<pre class="highlight python tab-python"><code><span class="k">print</span><span class="p">(</span><span class="s">"Starting "</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre>
<p>Returns the simulator name that was passed in when constructed.</p>

<h2 id="predict">predict</h2>
<pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
        <span class="c"># calculate reward...</span>

    <span class="o">...</span>
</code></pre>
<p>Returns a value indicating whether the simulation is set up to run in predict mode or training mode.</p>

<h2 id="objective_name">objective_name</h2>
<pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">episode_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_name</span><span class="p">)</span>
    <span class="o">...</span>
</code></pre>
<p>Property accessor that returns the name of the current objective from Inkling.
The objective may be updated before <code class="prettyprint">episode_start</code> is called. When running
for prediction and during start up, objective will return an empty string.</p>

<h2 id="episode_start-parameters-initial_state">episode_start(parameters, initial_state)</h2>

<blockquote>
<p>Example Inkling:</p>
</blockquote>
<pre class="highlight inkling tab-inkling"><code><span class="k">schema</span> <span class="nx">Config</span>
    <span class="kr">UInt8</span> <span class="nx">start_angle</span>
<span class="k">end</span>

<span class="k">schema</span> <span class="nx">State</span>
    <span class="kr">Float32</span> <span class="nx">angle</span><span class="p">,</span>
    <span class="kr">Float32</span> <span class="nx">velocity</span>
<span class="k">end</span>
</code></pre>
<blockquote>
<p>Example code:</p>
</blockquote>
<pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">episode_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="c"># training params are only passed in during training</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">start_angle</span>

    <span class="n">initial</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"angle"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span>
        <span class="s">"velocity"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">initial</span>
</code></pre>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">parameters</code></td>
<td>InklingMessage of episode initialization parameters as defined in inkling. <code class="prettyprint">parameters</code> will be populated if a training session is running.</td>
</tr>
<tr>
<td><code class="prettyprint">initial_state</code></td>
<td>Output InklingMessage. The subclasser should populate this message with the initial state of the simulation.</td>
</tr>
</tbody></table>

<p>This callback passes in a set of initial parameters and expects an initial state in return
for the simulator. Before this callback is called, the property <code class="prettyprint">objective_name</code> will be
updated to reflect the current objective for this episode.</p>

<p>This call is where a simulation should be reset for the next round.</p>

<p>The default implementation will throw an exception.</p>

<h2 id="simulate-action-state-reward-terminal">simulate(action, state, reward, terminal)</h2>

<blockquote>
<p>Example Inkling:</p>
</blockquote>
<pre class="highlight inkling tab-inkling"><code><span class="k">schema</span> <span class="nx">Action</span>
    <span class="kr">Int8</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">}</span> <span class="nx">delta</span>
<span class="k">end</span>
</code></pre>
<blockquote>
<p>Example code:</p>
</blockquote>
<pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
    <span class="n">velocity</span> <span class="o">=</span> <span class="n">velocity</span> <span class="o">-</span> <span class="n">action</span><span class="o">.</span><span class="n">delta</span><span class="p">;</span>
    <span class="n">terminal</span> <span class="o">=</span> <span class="p">(</span><span class="n">velocity</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span>

    <span class="c"># reward is only needed during training</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
        <span class="n">reward</span> <span class="o">=</span> <span class="n">reward_for_objective</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_name</span><span class="p">)</span>

    <span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"velocity"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">,</span>
        <span class="s">"angle"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminal</span><span class="p">)</span>
</code></pre>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">action</code></td>
<td>Input InklingMessage of action to be taken as defined in inkling.</td>
</tr>
<tr>
<td><code class="prettyprint">state</code></td>
<td>Output InklingMessage. Should be populated with the current simulator state.</td>
</tr>
<tr>
<td><code class="prettyprint">reward</code></td>
<td>Output reward value as calculated based upon the objective.</td>
</tr>
<tr>
<td><code class="prettyprint">terminal</code></td>
<td>Output terminal state. Set to true if the simulator is in a terminal state.</td>
</tr>
</tbody></table>

<p>This callback steps the simulation forward by a single step. It passes in
the <code class="prettyprint">action</code> to be taken, and expects the resulting <code class="prettyprint">state</code>, <code class="prettyprint">reward</code> for the current
<code class="prettyprint">objective</code>, and a <code class="prettyprint">terminal</code> flag used to signal the end of an episode. Note that an
episode may be reset prematurely by the backend during training.</p>

<p>For a multi-lesson curriculum, the <code class="prettyprint">objective_name</code> will change from episode to episode.
In this case ensure that the simulator is returning the correct reward for the
different lessons.</p>

<p>Returning <code class="prettyprint">true</code> for the <code class="prettyprint">terminal</code> flag signals the start of a new episode.</p>

<p>The default implementation will throw an exception.</p>

<h2 id="run">run()</h2>
<pre class="highlight python tab-python"><code><span class="n">sim</span> <span class="o">=</span> <span class="n">MySimulator</span><span class="p">(</span><span class="n">brain</span><span class="p">)</span>

<span class="k">if</span> <span class="n">sim</span><span class="o">.</span><span class="n">predict</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Predicting against "</span><span class="p">,</span> <span class="n">brain</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">" version "</span><span class="p">,</span> <span class="n">brain</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Training "</span><span class="p">,</span> <span class="n">brain</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="k">while</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">():</span>
    <span class="k">continue</span>
</code></pre>
<p>Main loop call for driving the simulation. Returns <code class="prettyprint">false</code> when the
simulation has finished or halted.</p>

<p>The client should call this method in a <code class="prettyprint">while</code> loop until it returns <code class="prettyprint">false</code>.
To run for prediction, <code class="prettyprint">brain()-&gt;config()-&gt;predict()</code> must return <code class="prettyprint">true</code>.</p>

<h2 id="episode_finish">episode_finish()</h2>
<pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">episode_finish</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Episode:'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span><span class="p">,</span>
          <span class="s">'reward:'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_reward</span><span class="p">)</span>
</code></pre>
<p>This callback is called at the end of each episode. You can use it to log
out statistical information, or perform post episode cleanup.</p>

<h2 id="record_file">record_file</h2>
<pre class="highlight python tab-python"><code><span class="n">my_sim</span><span class="o">.</span><span class="n">record_file</span> <span class="o">==</span> <span class="s">"/path/to/foobar.json"</span>
<span class="n">my_sim</span><span class="o">.</span><span class="n">record_file</span> <span class="o">=</span> <span class="s">"/path/to/barfoo.json"</span>

<span class="n">my_sim</span><span class="o">.</span><span class="n">record_file</span> <span class="o">==</span> <span class="s">"/path/to/foobar.csv"</span>
<span class="n">my_sim</span><span class="o">.</span><span class="n">record_file</span> <span class="o">=</span> <span class="s">"/path/to/foobar.csv"</span>
</code></pre>
<p>Getter and setter for analytics recording file.</p>

<p>When a new record file is set, the previous file will be closed immediately. Subsequent log lines will be written to the new file.</p>

<h2 id="enable_keys-keys-prefix-none">enable_keys(keys, prefix=None)</h2>
<pre class="highlight python tab-python"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">brain</span> <span class="o">=</span> <span class="n">Brain</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">MySimulator</span><span class="p">(</span><span class="n">brain</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">enable_keys</span><span class="p">([</span><span class="s">"foo"</span><span class="p">,</span> <span class="s">"bar"</span><span class="p">])</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">enable_keys</span><span class="p">([</span><span class="s">"baz"</span><span class="p">],</span> <span class="s">"qux"</span><span class="p">)</span>
</code></pre>
<p>This function adds the given keys to the log schema for this writer.
If one is provided, the prefix will be prepended to those keys and
they will appear as such in the resulting logs.
If recording is not enabled, this method has no effect.</p>

<p>You should enable any keys you expect to see in the logs. If you
attempt to insert objects containing keys which have not been
enabled, those keys will be silently ignored.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">keys</code></td>
<td>A list/vector of strings to include as keys in log entries for this simulator.</td>
</tr>
<tr>
<td><code class="prettyprint">prefix</code></td>
<td>A <code class="prettyprint">string</code> used as a subdomain for the given <code class="prettyprint">keys</code>. Entries will appear as <code class="prettyprint">&lt;prefix&gt;.&lt;key&gt;</code> for each <code class="prettyprint">key</code> in <code class="prettyprint">keys</code>. Defaults to empty string.</td>
</tr>
</tbody></table>

<h2 id="record_append-obj-prefix-none">record_append(obj, prefix=None)</h2>
<pre class="highlight python tab-python"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">brain</span> <span class="o">=</span> <span class="n">Brain</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">MySimulator</span><span class="p">(</span><span class="n">brain</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">enable_keys</span><span class="p">([</span><span class="s">"foo"</span><span class="p">,</span> <span class="s">"bar"</span><span class="p">])</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">enable_keys</span><span class="p">([</span><span class="s">"baz"</span><span class="p">],</span> <span class="s">"qux"</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">():</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">record_append</span><span class="p">({</span>
            <span class="s">"foo"</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span>
            <span class="s">"bar"</span><span class="p">:</span> <span class="mi">5</span>
        <span class="p">})</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">record_append</span><span class="p">({</span>
            <span class="s">"baz"</span><span class="p">:</span> <span class="s">"zabow"</span>
        <span class="p">},</span> <span class="s">"qux"</span><span class="p">)</span>
</code></pre>
<p>Adds the keys (prepended by <code class="prettyprint">prefix</code>, if provied) from the given dictionary to the current log entry. If recording is not enabled, this method has no effect. If a particular subset of the keys in <code class="prettyprint">obj</code> are not enabled, they will be ignored silently.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">obj</code></td>
<td>A dictionary containing data to be added to the current log entry.</td>
</tr>
<tr>
<td><code class="prettyprint">prefix</code></td>
<td>String prefix for the keys in <code class="prettyprint">obj</code>.</td>
</tr>
</tbody></table>

<h2 id="get_next_event">get_next_event()</h2>
<pre class="highlight python tab-python"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">brain</span> <span class="o">=</span> <span class="n">Brain</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">MySimulator</span><span class="p">(</span><span class="n">brain</span><span class="p">)</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_next_event</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">EpisodeStartEvent</span><span class="p">):</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">episode_start</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">initial_properties</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">initial_state</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">SimulateEvent</span><span class="p">):</span>
            <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminal</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span>
            <span class="n">event</span><span class="o">.</span><span class="n">reward</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">reward</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">terminal</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">EpisodeFinishEvent</span><span class="p">):</span>
            <span class="n">sim</span><span class="o">.</span><span class="n">episode_finish</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">FinishedEvent</span><span class="p">):</span>
            <span class="n">sim</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">UnknownEvent</span><span class="p">):</span>
            <span class="k">pass</span>
</code></pre>
<p>Advance the SDK&rsquo;s internal state machine and return an event for processing.</p>

<p>This is the primary entrypoint for the &ldquo;Event Pump&rdquo; interface. With this,
custom run loop implementations are possible in user code. Rather than calling
<code class="prettyprint">Simulator.run</code> in a loop, communication between simulation code and Bonsai backend
can be accomplished step by step.</p>

<h2 id="close">close()</h2>

<p>Close the internal websocket.</p>

          <h1 id="predictor-class">Predictor Class</h1>

<blockquote>
<p>Example Inkling:</p>
</blockquote>
<pre class="highlight inkling tab-inkling"><code>    <span class="k">simulator</span> <span class="nx">my_simulator</span><span class="p">(</span><span class="nx">Config</span><span class="p">)</span>
        <span class="k">action</span> <span class="p">(</span><span class="nx">Action</span><span class="p">)</span>
        <span class="k">state</span> <span class="p">(</span><span class="nx">State</span><span class="p">)</span>
    <span class="k">end</span>
</code></pre>
<blockquote>
<p>Example code:</p>
</blockquote>
<pre class="highlight python tab-python"><code><span class="c"># As a context manager:</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="n">brain</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Brain</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">Predictor</span><span class="p">(</span><span class="n">brain</span><span class="p">,</span> <span class="s">"my_simulator"</span><span class="p">)</span>

<span class="k">with</span> <span class="n">predictor</span><span class="p">:</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="c"># Without context manager:</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="n">brain</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Brain</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">Predictor</span><span class="p">(</span><span class="n">brain</span><span class="p">,</span> <span class="s">"my_simulator"</span><span class="p">)</span>

<span class="n">action</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">predictor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre>
<p>This class is used to interface with the server to obtain predictions for a specific BRAIN and
is a subclass of Simulator.</p>

<p>The <code class="prettyprint">Predictor</code> class is closely related to the Inkling file that is associated with the BRAIN.
The name used to construct <code class="prettyprint">Predictor</code> must match the name of the simulator in the Inkling file.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">brain</code></td>
<td>The name of the BRAIN to connect to.</td>
</tr>
<tr>
<td><code class="prettyprint">name</code></td>
<td>The name of this simulator. Must match simulator in Inkling.</td>
</tr>
</tbody></table>

<aside class="notice">
predict(), simulate(), and episode_start() are available methods in this class but should not be overwritten.
</aside>

<h2 id="get_action-self-state">get_action(self, state)</h2>

<p>Receives the Inkling action when sent a state.</p>

<h2 id="close-self">close(self)</h2>

<p>Closes a websocket connection. This is recommended when <code class="prettyprint">predictor()</code> is used outside of the context manager.</p>

          <h1 id="logger-class">Logger Class</h1>

<p>The <code class="prettyprint">Logger</code> class serves as an entry point for runtime logging to <code class="prettyprint">stderr</code>. All instances of <code class="prettyprint">Logger</code> 
share the same internal state, so enabling a particular log domain for a <code class="prettyprint">Logger</code> in any scope
enables that log domain for all <code class="prettyprint">Logger</code> instances in the current process.</p>

<h2 id="logger">Logger()</h2>
<pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">bonsai_ai.logger</span> <span class="kn">import</span> <span class="n">Logger</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">MySim</span><span class="p">(</span><span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Simulator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">mydomain</span><span class="p">(</span><span class="s">"My Log Info"</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="n">log</span><span class="o">.</span><span class="n">set_enabled</span><span class="p">(</span><span class="s">"mydomain"</span><span class="p">)</span>
    <span class="o">...</span>

</code></pre>
<p>Return an instance of <code class="prettyprint">Logger</code> that reflects the shared state of all active Loggers.</p>

<h2 id="set_enabled-key">set_enabled(key)</h2>
<pre class="highlight python tab-python"><code><span class="n">log</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">Logger</span><span class="p">()</span>
<span class="n">log</span><span class="o">.</span><span class="n">set_enabled</span><span class="p">(</span><span class="s">"foobar"</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">foobar</span><span class="p">(</span><span class="s">"baz"</span><span class="p">)</span> <span class="c"># logs "baz" to stderr (along with timestamp and domain info)</span>
<span class="n">log</span><span class="o">.</span><span class="n">barfoo</span><span class="p">(</span><span class="s">"zab"</span><span class="p">)</span> <span class="c"># no log, no error</span>
</code></pre>
<p>Enables the given log domain for all active Loggers.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">key</code></td>
<td>A string describing which log domain to enable.</td>
</tr>
</tbody></table>

<h2 id="set_enable_all-enable_all">set_enable_all(enable_all)</h2>
<pre class="highlight python tab-python"><code><span class="n">log</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">Logger</span><span class="p">()</span>
<span class="n">log</span><span class="o">.</span><span class="n">set_enable_all</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">foobar</span><span class="p">(</span><span class="s">"baz"</span><span class="p">)</span> <span class="c"># logs "baz" to stderr (along with timestamp and domain info)</span>
<span class="n">log</span><span class="o">.</span><span class="n">barfoo</span><span class="p">(</span><span class="s">"zab"</span><span class="p">)</span> <span class="c"># logs "zab" to stderr (along with timestamp and domain info)</span>
</code></pre>
<p>When set, the <code class="prettyprint">Logger</code> prints any message, regardless of whether the particular domain
was explicitly enabled. Corresponds to the <code class="prettyprint">--verbose</code> command line flag.</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">enable_all</code></td>
<td>A bool describing whether verbose logging is enabled.</td>
</tr>
</tbody></table>

          <h1 id="event-class">Event Class</h1>

<p>Internally, the Bonsai library uses a state machine to drive activity in user
code (i.e. advancing and recording simulator state, resetting a simulator, etc).
State transfer is driven primarily by a websocket-based messaging protocol
shared between the library and the Bonsai AI platform. For your convenience,
the details of this protocol have been hidden behind a pair of API&rsquo;s, one based
on callbacks in <code class="prettyprint">bonsai_ai.Simulator</code> and the other event driven.</p>

<p>Filling out the callbacks in <code class="prettyprint">bonsai_ai.Simulator</code> and relying on
<code class="prettyprint">Simulator.run</code> to invoke them at the appropriate time will be sufficient for
many use cases. For example, if you have a simulator which can be advanced,
reset, and observed in a synchronous manner from Python or C++ code, your
application is likely amenable to our callback API. However, if, for example,
your simulator is free running and communicates with your application code
asynchronously, your application will likely need to employ the event driven
API described below.</p>

<p>In the <strong>event-driven mode of operation</strong>, you application code should implement
its own run loop by requesting successive events from the Bonsai library and
handling them in a way that is appropriate to your particular simulation or
deployment architecture. For example, if your simulator invokes callbacks into
your code and is reset in response to some outgoing signal (i.e. not via a
method call), you might respond to an <code class="prettyprint">EpisodeStartEvent</code> by setting the
appropriate flag, returning control to the simulator, and returning the
resulting state to the Bonsai platform the next time your callback gets invoked.</p>

<h2 id="episodestartevent">EpisodeStartEvent</h2>
<pre class="highlight python tab-python"><code><span class="n">event</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_next_event</span><span class="p">()</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">EpisodeStartEvent</span><span class="p">):</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">episode_start</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">initial_properties</span><span class="p">)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">initial_state</span> <span class="o">=</span> <span class="n">state</span>
</code></pre>
<p>This event is generated at the start of a training episode.
It is triggered either by a terminal condition in the simulator
or by the platform itself.</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">initial_properties</code></td>
<td>Configuration properties for the simulator.</td>
</tr>
<tr>
<td><code class="prettyprint">initial_state</code></td>
<td>Assign the state resulting from a model reset.</td>
</tr>
</tbody></table>

<p><code class="prettyprint">initial_properties</code> is the configuration sent down from the server
in the form of a dictionary matching the config specified in Inkling.</p>

<h2 id="simulateevent">SimulateEvent</h2>
<pre class="highlight python tab-python"><code><span class="n">event</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_next_event</span><span class="p">()</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">SimulateEvent</span><span class="p">):</span>
    <span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminal</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">event</span><span class="o">.</span><span class="n">reward</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">reward</span><span class="p">)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">terminal</span><span class="p">)</span>
</code></pre>
<p>This event is generated when an action (prediction) is ready
to be fed into the simulator.</p>

<p>Assign values to a <code class="prettyprint">SimulateEvent</code> by assigning a dictionary whose fields match
the state schema. You will need to set the values before the next
<code class="prettyprint">Simulator.get_next_event</code> call. The values get sent back to the brain during
the call to Simulator.get_next_event.</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">action</code></td>
<td>Next action (prediction) in the queue.</td>
</tr>
<tr>
<td><code class="prettyprint">state</code></td>
<td>Assign the resulting state after updating the model.</td>
</tr>
<tr>
<td><code class="prettyprint">reward</code></td>
<td>The reward calculated from the updated.</td>
</tr>
<tr>
<td><code class="prettyprint">terminal</code></td>
<td>Whether the updated state is terminal.</td>
</tr>
</tbody></table>

<h2 id="finishedevent">FinishedEvent</h2>
<pre class="highlight python tab-python"><code><span class="n">event</span> <span class="o">=</span> <span class="n">get_next_event</span><span class="p">()</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">FinishedEvent</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre>
<p>Indicates that the Bonsai Platform has terminated training.</p>

<h2 id="unknownevent">UnknownEvent</h2>

<p>Catch-all event for other internal states. This event can be safely ignored,
but it is provided for completeness and is handy for explicitly tracking state
transitions from client code.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>

    </div>

  </div>
  <!-- at the end of the BODY -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
  <script type="text/javascript"> docsearch({
  apiKey: '49fa6f01d7ff94a85b9b7434b1c2b7cf',
  indexName: 'bon-sai',
  inputSelector: '#docs-search',
  debug: false // Set debug to true if you want to inspect the dropdown
  });
  </script>
  </body>
</html>
