


<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Simulator Reference - Bonsai</title>
    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">WebFont.load({  google: {    families: ["Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic"]  }});</script>
    <link href="../stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" media="print" />
	  <link href="../stylesheets/test.css" rel="stylesheet" media="screen" />
    <link href="../favicon.ico" rel="icon" type="image/ico" />
      <script src="../javascripts/all.js"></script>
      <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WVB6MG2');</script>
<!-- End Google Tag Manager -->
      <!-- start Mixpanel -->
<script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
mixpanel.init("91fbf7b68fb2356f91916026f221ddd5", {
    loaded: function(mixpanel) {
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        distinct_id = getParameterByName('refUserId');
        if (distinct_id) {
          mixpanel.identify(distinct_id);
        }
    }
});</script>
<!-- end Mixpanel -->

  </head>

  <body class="references references_simulator-reference" data-languages="[]">


	  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WVB6MG2"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --> 

  <div id="flex-container">

	<nav id="primary-nav">



	<div id="logo"> <a href="../"><img class="bonsai-logo" src="../images/bonsai-logo.svg"></a></div>

	<label for="drop" class="toggle"><img class="menu-ham" src="../images/menu.svg"></label>
	<input type="checkbox" id="drop" />

	<ul class="menu">

		<li class="header_menu_item "> <a href="../guides/getting-started.html">Quick Start</a></li>

		<li class="header_menu_item"> <!-- First Tier Drop Down --> <label for="drop-1" class="toggle">Tutorials +</label><a  href="#">Tutorials</a>
			<input type="checkbox" id="drop-1"/>
			<ul id="tutorials">
				<li class=""> <a href="../guides/cli-install-guide.html">Install the CLI</a>  </li>
				<li class=""> <a href="../guides/sdk-install-guide.html">Install the SDK</a>  </li>
				<li class=""> <a href="../tutorials/tutorial1.html">Running Simulations and Writing Inkling</a>  </li>
				<li class=""> <a href="../guides/local-dev-guide.html">Run the Platform Locally</a>  </li>
				<li class=""> <a href="../guides/jupyter-api-guide.html">Use Bonsai's API with Jupyter</a>  </li>
			</ul>
		</li>

		<li class="header_menu_item"> <!-- First Tier Drop Down --> <label for="drop-2" class="toggle">Guides +</label><a  href="#">Guides</a>
			<input type="checkbox" id="drop-2"/>
			<ul id="guides">
				<li class=""> <a href="../guides/simulation-guide.html">Learn About Simulation Requirements</a>  </li>
				<li class=""> <a href="../guides/inkling-guide.html">Learn the Inkling Language</a>  </li>
				<li class=""> <a href="../guides/machine-teaching.html">Programming Machine Teaching</a>  </li>
				<li class=""> <a href="../guides/ai-engine-guide.html">Understand AI Engine Components</a>  </li>
				<li class=""> <a href="../guides/web-graphs-guide.html">Understand BRAIN Graphs</a>  </li>
			</ul>
		</li>

		<li class="header_menu_item"> <!-- First Tier Drop Down --> <label for="drop-3" class="toggle">References +</label><a  href="#">References</a>
			<input type="checkbox" id="drop-3"/>
			<ul id="references">
				<li class=""> <a href="api-reference.html">API Reference</a>  </li>
				<li class=""> <a href="cli-reference.html">CLI Reference</a>  </li>
				<li class=""> <a href="inkling-reference.html">Inkling Reference</a>  </li>
				<li class="selected"> <a href="simulator-reference.html">Simulator Reference</a>
				<li class=""> <a href="library-reference.html">Python Library</a>  </li>
				<li class=""> <a href="cpp-library-reference.html">C++ Library</a>  </li>
				
			</ul> 
		</li>

		<li class="header_menu_item "> <a href="../examples.html">Examples</a></li>

		<li>
			<input type="search" id="docs-search" placeholder="Search Bonsai Docs">
		</li>


	</ul>

</nav>


	<div id="main-wrapper">

    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">

        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div class="page-title">Simulator Reference</div>
      <div id="toc">
      </div>

			 
<ul class="toc-footer">

<li><a href='https://bons.ai'>Bonsai Home</a></li>
<li><a href='https://beta.bons.ai'>BRAIN Dashboard</a></li>
<li><a href='https://github.com/BonsaiAI/slate'>Contribute to the Docs</a></li>
<li><a href='http://pages.bons.ai/apply.html'>Apply for Bonsai Platform Preview</a></li>
<li><a href="/releases.html">Product Release Notes</a></li>
<li><a href='https://bons.ai/contact-us#contact-page-form'>Contact Us</a></li>

</ul>


	   <div class="cc-bottom">
	
	<div class="toc-footer bottom cc-info">

		<a href='https://creativecommons.org/licenses/by-sa/4.0/' class="cc-icon-width" >
			<svg class="cc" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
			viewBox="0 0 70.7 13.4" style="enable-background:new 0 0 70.7 13.4;" xml:space="preserve">

				<g>

				<g>
				<circle class="st0" cx="6.8" cy="6.7" r="6.1"/>
				<path d="M6.7,0c1.9,0,3.5,0.7,4.8,2c0.6,0.6,1.1,1.4,1.4,2.2c0.3,0.8,0.5,1.7,0.5,2.6c0,0.9-0.2,1.8-0.5,2.6
				c-0.3,0.8-0.8,1.5-1.4,2.1c-0.7,0.6-1.4,1.1-2.2,1.5c-0.8,0.3-1.7,0.5-2.6,0.5S5,13.3,4.2,12.9c-0.8-0.3-1.5-0.8-2.2-1.5
				s-1.1-1.4-1.5-2.2S0,7.6,0,6.7C0,5.8,0.2,5,0.5,4.2S1.3,2.6,2,2C3.3,0.7,4.8,0,6.7,0z M6.7,1.2c-1.5,0-2.8,0.5-3.9,1.6
				C2.3,3.4,1.9,4,1.6,4.6C1.4,5.3,1.2,6,1.2,6.7c0,0.7,0.1,1.4,0.4,2.1c0.3,0.7,0.7,1.3,1.2,1.8c0.5,0.5,1.1,0.9,1.8,1.2
				c0.7,0.3,1.4,0.4,2.1,0.4c0.7,0,1.4-0.1,2.1-0.4c0.7-0.3,1.3-0.7,1.8-1.2c1-1,1.6-2.3,1.6-3.9c0-0.7-0.1-1.4-0.4-2.1
				c-0.3-0.7-0.7-1.3-1.2-1.8C9.5,1.8,8.2,1.2,6.7,1.2z M6.6,5.6L5.7,6.1C5.6,5.9,5.5,5.7,5.4,5.6C5.3,5.6,5.1,5.5,5,5.5
				c-0.6,0-0.9,0.4-0.9,1.2c0,0.4,0.1,0.6,0.2,0.9C4.5,7.8,4.7,7.9,5,7.9c0.4,0,0.7-0.2,0.8-0.6l0.8,0.4C6.5,8.1,6.2,8.3,5.9,8.5
				c-0.3,0.2-0.7,0.3-1,0.3c-0.6,0-1.1-0.2-1.5-0.6C3.1,7.9,2.9,7.4,2.9,6.7c0-0.6,0.2-1.1,0.6-1.5c0.4-0.4,0.8-0.6,1.4-0.6
				C5.7,4.6,6.3,5,6.6,5.6z M10.5,5.6L9.6,6.1C9.5,5.9,9.4,5.7,9.3,5.6C9.1,5.6,9,5.5,8.9,5.5C8.3,5.5,8,5.9,8,6.7
				c0,0.4,0.1,0.6,0.2,0.9c0.2,0.2,0.4,0.3,0.7,0.3c0.4,0,0.7-0.2,0.8-0.6l0.8,0.4c-0.2,0.3-0.4,0.6-0.7,0.8c-0.3,0.2-0.7,0.3-1,0.3
				c-0.6,0-1.1-0.2-1.5-0.6C7,7.9,6.8,7.4,6.8,6.7c0-0.6,0.2-1.1,0.6-1.5c0.4-0.4,0.8-0.6,1.4-0.6C9.6,4.6,10.2,5,10.5,5.6z"/>
				</g>

				</g>
			</svg>
		</a>
		
		<a href='https://creativecommons.org/licenses/by-sa/4.0/'>Content:
		CC-BY-SA </a>
		
	</div>

</div>

    </div>

    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="simulator-overview">Simulator Overview</h1>

<blockquote>
<p><img src="../images/brain-sim-marketing.png" alt="Simulator Diagram" /></p>
</blockquote>

<p>This reference gives you the information you’ll need to train a BRAIN on The Bonsai Platform with simulators. It covers best practices such as running simulations in parallel, general guidelines like how to configure web proxies with the CLI, and what simulators are currently supported.</p>

<p>Currently, The Bonsai Platform depends on simulators as a source of training data for applied deep reinforcement learning (DRL). For more background on applied DRL with simulations read our blog post on <a href="https://bons.ai/blog/simulators-deep-reinforcement-learning">simulations as a training environment</a>.</p>

<p>The Bonsai Platform includes client libraries for Python &amp; C++, two common languages used in systems modeling. We also have samples showing how to connect to OpenAI Gym Environments and EnergyPlus models. To learn more about connecting your simulator, refer to our <a href="library-reference.html">Library Reference</a>.</p>

<h2 id="what-is-a-simulator">What is a simulator?</h2>

<p>A simulator is an imperative model of a process, transitioning from state to state as actions are applied. Robotics, industrial automation, supply chain logistics, and structural engineering are all domains which use simulators to model the behavior of complex systems.</p>

<p>Deep Reinforcement Learning can work with simulated models to train a BRAIN to perform tasks within the modeled system. Tasks can be as simple as &ldquo;stand this pole upright&rdquo; or as complex as &ldquo;learn to walk.&rdquo; </p>

<p>To be effective, training a BRAIN needs to be done using DRL against a simulated model. The Bonsai SDK allows the DRL system to control your simulator during the training process. Any simulator which has an initial state, and increments through time, can connect to the Bonsai training system.</p>

<h2 id="currently-integrated-simulators">Currently Integrated Simulators</h2>

<p>The Bonsai Platform supports an API and two client libraries written in Python or C++. The platform also includes connectors built on top of these libraries. Currently available connectors:</p>

<ul>
<li>OpenAI Gym Environments (bonsai-gym)</li>
<li>EnergyPlus (via BCVTB)</li>
</ul>

<p>A list of examples using these are on the <a href="../examples.html">Examples</a> page.</p>

<h1 id="integrating-a-simulator-with-inkling">Integrating a Simulator with Inkling</h1>

<blockquote>
<p><img src="../images/inkling_simulator_comparison.png" alt="Simulator Diagram" /></p>
</blockquote>

<p>This table describes the colors and connections between the various parts of the Inkling file and Simulator file that must be the same or connected. The source code for this example, <a href="../examples.html#inkling-file">Find the Center</a>, is available if you wish to copy/paste this example.</p>

<table><thead>
<tr>
<th>Color</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Purple (dark/light)</td>
<td>The Inkling state schema field names and types must match the state dictionaries returned from <code class="prettyprint">episode_start</code> and <code class="prettyprint">simulate</code> in the simulator.</td>
</tr>
<tr>
<td>Blue (dark/light)</td>
<td>The Inkling action schema field names will match the keys in the action dictionary passed to <code class="prettyprint">simulate</code> in the simulator, and the values will have the types specified in Inkling, and will obey the specified constraints (<code class="prettyprint">{-1, 0, 1}</code> in the example).</td>
</tr>
<tr>
<td>Orange (dark/light)</td>
<td>The simulator&rsquo;s configuration passes as <code class="prettyprint">parameters</code> to the <code class="prettyprint">episode_start</code>, and will take values from the <code class="prettyprint">constrain</code> clause in Inkling.</td>
</tr>
<tr>
<td>Red</td>
<td>The name of the concept must match the <code class="prettyprint">train</code> clause in the curriculum for that concept.</td>
</tr>
<tr>
<td>Green</td>
<td>The simulator name must match between the <code class="prettyprint">simulator</code> clause and the <code class="prettyprint">with simulator</code> clause in the curriculum. The simulator must pass the same name to the constructor of the <code class="prettyprint">Simulator</code> class, so the AI engine knows which simulator is connected.</td>
</tr>
<tr>
<td>Turquoise</td>
<td>The name of the optimization objective or reward function appears twice in the Inkling, and is available as <code class="prettyprint">self.objective_name</code> in the simulator.</td>
</tr>
</tbody></table>

<aside class="notice">
Note that config in __main__ is the brain configuration and remains the same throughout, whereas goal_config (highlighted in orange) is used at the beginning of every episode and must be named the same as it is in Inkling. These configs are unrelated.
</aside>

<h1 id="running-a-simulator-from-the-cli">Running a Simulator from the CLI</h1>

<blockquote>
<p>Simulator config help text</p>
</blockquote>
<pre class="highlight plaintext"><code>$ python &lt;simulator_file&gt;.py --help
usage: &lt;simulator_file&gt;.py [-h] [--accesskey ACCESSKEY] [--username USERNAME]
                 [--url URL] [--proxy PROXY] [--brain BRAIN]
                 [--predict [PREDICT]] [--verbose] [--performance]
                 [--log LOG [LOG ...]] [--record RECORD]

optional arguments:
  -h, --help            show this help message and exit
  --accesskey ACCESSKEY
                        The access key to use when connecting to the BRAIN
                        server. If specified, it will be used instead of any
                        access key information stored in a bonsai config file.
  --username USERNAME   Bonsai username.
  --url URL             Bonsai server URL. The URL should be of the form
                        "https://api.bons.ai"
  --proxy PROXY         Proxy server address and port. Example: localhost:3128
  --brain BRAIN         The name of the BRAIN to connect to. Unless a version
                        is specified the BRAIN will connect for training.
  --predict [PREDICT]   If set, the BRAIN will connect for prediction with the
                        specified version. May be a positive integer number or
                        'latest' for the most recent version. For example:
                        --predict=latest or --predict=3
  --verbose             Enables logging. Alias for --log=all
  --performance         Enables time delta logging. Alias for --log=perf.all
  --log LOG [LOG ...]   Enable logging. Parameters are a list of log domains.
                        Using --log=all will enable all domains. Using
                        --log=none will disable logging.
  --record RECORD       Enable record simulation data to a file (current) or
                        external service (not yet implemented). Parameter is
                        the target file for recorded data. Data format will be
                        inferred from the file extension. Currently supports
                        ".json" and ".csv".
</code></pre>
<p>Currently, all connectors use a Python program to bootstrap the simulation and connect it to the Bonsai AI Engine. To run any simulation, you call a Python program (shown in the code panel).</p>

<p>During development, you will need to iterate efficiently on your simulation, reward function, and lesson plans. You may also need to connect a debugger, or do additional logging to help you get your simulation ready to train.</p>

<p>During the course of normal operation, one should only need to specify the prediction/training mode on the command line. The rest of the options will be read from configuration files.</p>

<p>The following sections explain further how to use the <code class="prettyprint">--proxy</code>, <code class="prettyprint">--predict</code>, and <code class="prettyprint">--record</code> command line options.</p>

<p>To speed up training, you can run multiple simulators in parallel. See <a href="#running-simulators-in-parallel">Running Simulations in Parallel</a> below.</p>

<h2 id="proxy-support">Proxy Support</h2>

<blockquote>
<p>Example Python Proxy</p>
</blockquote>
<pre class="highlight python tab-python"><code><span class="n">my_config</span><span class="o">.</span><span class="n">proxy</span> <span class="o">==</span> <span class="s">'myproxy:5000'</span>
</code></pre>
<blockquote>
<p>Example CLI Proxy Usage</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>python &lt;simulator_file&gt;.py --proxy<span class="o">=</span>localhost:3128
</code></pre>
<p>To connect a simulator from behind a corporate proxy, tools like the Bonsai SDK need to know where to send traffic. This is done by providing the proxy server address and port to the simulator config when running a simulator. There are multiple ways that you can do this such as through the CLI or in the simulator code itself.</p>

<h3 id="environment-variables">Environment Variables</h3>

<blockquote>
<p>Set Windows Environment Variable</p>
</blockquote>
<pre class="highlight plaintext"><code># HTTPS_PROXY and HTTP_PROXY are also supported

| Variable       | Value                                      |
| -------------- | ------------------------------------------ |
| ALL_PROXY      | http://username:password@URL:3456          |
</code></pre>
<blockquote>
<p>Set macOS/Linux Environment Variable</p>
</blockquote>
<pre class="highlight sh tab-shell"><code><span class="c"># HTTPS_PROXY and HTTP_PROXY are also supported</span>

<span class="gp">$ </span><span class="nb">export </span><span class="nv">ALL_PROXY</span><span class="o">=</span>http://username:password@URL:3456 
</code></pre>
<p>If the previous usage for the SDK does not work for the CLI as well you may need to specify the proxy details as environment variables.  Proxy details differ between companies, so ask your IT staff for the proxy URL, port number, and if any login information such as username/password is also needed.</p>

<p>The examples shown use <code class="prettyprint">ALL_PROXY</code> but <code class="prettyprint">HTTPS_PROXY</code> and <code class="prettyprint">HTTP_PROXY</code> are also supported.</p>

<p><strong>Windows</strong></p>

<p>Go to System -&gt; Advanced system settings -&gt; Environment Variables to set these in Windows.</p>

<p><strong>macOS/Linux</strong></p>

<p>Use <code class="prettyprint">export</code> in macOS or Linux in a terminal window to set these variables into your PATH. You may wish to copy and paste this into your <code class="prettyprint">.bash_profile</code> for future use.</p>

<h2 id="prediction">Prediction</h2>
<pre class="highlight python tab-python"><code><span class="c"># Default version is latest</span>
<span class="n">python</span> <span class="o">&lt;</span><span class="n">simulator_file</span><span class="o">&gt;.</span><span class="n">py</span> <span class="o">--</span><span class="n">predict</span>

<span class="c"># OR</span>
<span class="n">Python</span> <span class="o">&lt;</span><span class="n">simulator_file</span><span class="o">&gt;.</span><span class="n">py</span> <span class="o">--</span><span class="n">predict</span><span class="o">=</span><span class="mi">1</span>
</code></pre>
<p>After your BRAIN is finished training it can be used to &ldquo;predict&rdquo; or perform in the simulation. How well it does depends on how long you let it train! Using your BRAIN involves running your simulator file as you did when training, but now in prediction mode with <code class="prettyprint">--predict</code>. The default is <code class="prettyprint">--predict=latest</code> which will use the version of the latest training session that you just ran. You can use a different version of your BRAIN if you have trained it multiple times by replacing <code class="prettyprint">latest</code> with the version number.</p>

<h2 id="recording-data-to-file">Recording Data to File</h2>

<blockquote>
<p>Record file example</p>
</blockquote>
<pre class="highlight python tab-python"><code><span class="c"># Excerpt of find_the_center_sim.py</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Config</span><span class="p">()</span>

    <span class="n">config</span><span class="o">-&gt;</span><span class="n">set_record_enabled</span><span class="p">(</span><span class="n">true</span><span class="p">);</span>
    <span class="n">config</span><span class="o">-&gt;</span><span class="n">set_record_file</span><span class="p">(</span><span class="s">"find_the_center.json"</span><span class="p">);</span>

    <span class="n">brain</span> <span class="o">=</span> <span class="n">bonsai_ai</span><span class="o">.</span><span class="n">Brain</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">BasicSimulator</span><span class="p">(</span><span class="n">brain</span><span class="p">,</span> <span class="s">"find_the_center_sim"</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">enable_keys</span><span class="p">([</span><span class="s">"delta_t"</span><span class="p">,</span> <span class="s">"goal_count"</span><span class="p">],</span> <span class="s">"ftc"</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">'starting...'</span><span class="p">)</span>
    <span class="n">last</span> <span class="o">=</span> <span class="n">clock</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000000</span>
    <span class="k">while</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">():</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">clock</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000000</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">record_append</span><span class="p">(</span>
            <span class="p">{</span><span class="s">"delta_t"</span><span class="p">:</span> <span class="n">now</span> <span class="o">-</span> <span class="n">last</span><span class="p">},</span> <span class="s">"ftc"</span><span class="p">)</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">clock</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000000</span>
        <span class="k">continue</span>
</code></pre>
<p>The full code for how to use this feature within an example can be found in the <a href="../examples.html#simulator-file">find-the-center example</a>.</p>

<p>Analytics recording can be enabled in code (shown in the code panel) or at the command line. The code example shown has the same effect as invoking this script with <code class="prettyprint">--record=find_the_center.json</code>. Alternatively, invoking with <code class="prettyprint">--record=find_the_center.csv</code> enables recording to CSV.</p>

<p>The syntax for how to use this feature within the SDK libraries see <a href="library-reference.html#record_file"><code class="prettyprint">record_file</code></a> for Python and <a href="cpp-library-reference.html#record_file"><code class="prettyprint">record_file()</code></a> for C++.</p>

<h1 id="cloud-hosted-simulators">Cloud Hosted Simulators</h1>

<p>The Bonsai Platform can run several simulators for you in our cloud environment. This means you can start and stop training all from the web interface, without needing to download and install the Bonsai CLI or SDK. You will still need to run the simulator locally using the CLI to obtain predictions, however.</p>

<p>Cloud-hosted simulators are useful for prolonged training to avoid your computer becoming idle and stopping training. At this time, you can only run one simulator cloud-hosted, and cannot take advantage of training speed increases from <a href="#running-simulators-in-parallel">running simulators in parallel</a>.</p>

<p>Current list of supported libraries for cloud-hosted training:</p>

<ul>
<li>OpenAI Gym environment: <a href="https://quay.io/repository/bonsai/gym"><code class="prettyprint">openai.gym</code></a></li>
<li>Bonsai Python <code class="prettyprint">bonsai-ai</code> library: <a href="https://quay.io/repository/bonsai/bonsai-ai"><code class="prettyprint">bonsai.ai</code></a></li>
<li>EnergyPlus Simulator: <a href="https://quay.io/repository/bonsai/energyplus"><code class="prettyprint">bonsai.energyplus</code></a></li>
<li>Legacy <code class="prettyprint">bonsai-python</code> library: <a href="https://quay.io/repository/bonsai/python"><code class="prettyprint">bonsai.python</code></a></li>
</ul>

<p>In order to set your BRAIN to use one of these cloud-hosted simulators, you’ll either need to start with a starter project and modify your BRAIN’s <a href="cli-reference.html#bproj-file">project (<code class="prettyprint">.bproj</code>) file</a> or use one of the Bonsai demo projects.</p>

<h1 id="running-simulations-in-parallel">Running Simulations in Parallel</h1>

<blockquote>
<p><img src="../images/multiple-sims.png" alt="Parallel Simulators" /></p>
</blockquote>

<p>Training can take a long time. Depending on the complexity of the problem and the way your lesson plans are written, training can take several hours to several days. Fortunately, training can happen in parallel. Each new simulator you connect to a running training session will increase the episode per second training rate which will help the BRAIN find better solutions faster. How much you can increase training depends on the speed of your simulation: if your simulation takes 1s per iteration, it will be beneficial to run dozens in parallel.</p>

<p>Running simulations in parallel is currently only supported either when running your simulator locally via the Bonsai CLI, or in your own private cloud on AWS or Azure. Simply connect multiple instances of your simulation to the same BRAIN to take advantage of this feature. Eventually, the system will no longer handle any more messages per second and you will see a plateau of improvement in training.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>

    </div>

  </div>
  <!-- at the end of the BODY -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
  <script type="text/javascript"> docsearch({
  apiKey: '49fa6f01d7ff94a85b9b7434b1c2b7cf',
  indexName: 'bon-sai',
  inputSelector: '#docs-search',
  debug: false // Set debug to true if you want to inspect the dropdown
  });
  </script>
  </body>
</html>
