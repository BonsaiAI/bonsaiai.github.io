


<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Library Reference - Bonsai</title>
    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link href="../stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" media="print" />
	  <link href="../stylesheets/test.css" rel="stylesheet" media="screen" />
    <link href="../favicon.ico" rel="icon" type="image/ico" />
      <script src="../javascripts/all.js"></script>
	
	  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WVB6MG2');</script>
<!-- End Google Tag Manager -->
  </head>

  <body class="sdk2-beta sdk2-beta_library-reference" data-languages="[&quot;cpp&quot;,&quot;python&quot;]">
	  
	  
	  <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WVB6MG2"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --> 

  <div id="flex-container">

	<nav id="primary-nav">



	<div id="logo"> <a href="../"><img class="bonsai-logo" src="../images/bonsai-logo.svg"></a></div>

	<label for="drop" class="toggle"><img class="menu-ham" src="../images/menu.svg"></label>
	<input type="checkbox" id="drop" />

	<ul class="menu">

		<li class="header_menu_item "> <a href="../guides/getting-started.html">Quick Start</a></li>

	
		<li class="header_menu_item"> <!-- First Tier Drop Down --> <label for="drop-1" class="toggle">Guides +</label><a  href="#">Guides</a>			
			<input type="checkbox" id="drop-1"/>
			<ul id="guides">
				<li class=""> <a href="../guides/ai-engine-guide.html">AI Engine Guide</a>  </li>
				<li class=""> <a href="../guides/inkling-guide.html">Inkling Guide</a>  </li>
				<li class=""> <a href="../guides/cli-install-guide.html">Install the CLI</a>  </li>
				<li class=""> <a href="../guides/local-dev-guide.html">Run the Platform Locally</a>  </li>
				<li class=""> <a href="../guides/web-graphs-guide.html">Understanding BRAIN Graphs</a>  </li>
			</ul> 
		</li>

		<li class="header_menu_item"> <!-- First Tier Drop Down --> <label for="drop-2" class="toggle">References +</label><a  href="#">References</a>			
			<input type="checkbox" id="drop-2"/>
			<ul id="references">
				<li class=""> <a href="../references/api-reference.html">API</a>  </li>
				<li class=""> <a href="../references/cli-reference.html">CLI</a>  </li>
				<li class=""> <a href="../references/inkling-reference.html">Inkling</a>  </li>
				<li class=""> <a href="../references/library-reference.html">Library</a>  </li>
			</ul> 
		</li>
		
		<li class="header_menu_item "> <a href="../examples.html">Examples</a></li>

		<li>
			<input type="search" id="docs-search" placeholder="Search Bonsai Docs">
		</li>


	</ul>

</nav>





	<div id="main-wrapper">

    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">

        <div class="lang-selector">
              <a href="#" data-language-name="cpp">cpp</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div class="page-title">Library Reference</div>
      <div id="toc">
      </div>
      
			 
<ul class="toc-footer">

<li><a href='https://bons.ai'>Bonsai Home</a></li>
<li><a href='https://beta.bons.ai'>BRAIN Dashboard</a></li>
<li><a href='https://github.com/BonsaiAI/slate'>Contribute to the Docs</a></li>
<li><a href='http://pages.bons.ai/apply.html'>Apply for Bonsai Platform Preview</a></li>
<li><a href='https://bons.ai/contact-us#contact-page-form'>Contact Us</a></li>

</ul>
       
        
	   <div class="cc-bottom">
	
	<div class="toc-footer bottom cc-info">

		<a href='https://creativecommons.org/licenses/by-sa/4.0/' class="cc-icon-width" >
			<svg class="cc" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
			viewBox="0 0 70.7 13.4" style="enable-background:new 0 0 70.7 13.4;" xml:space="preserve">

				<g>

				<g>
				<circle class="st0" cx="6.8" cy="6.7" r="6.1"/>
				<path d="M6.7,0c1.9,0,3.5,0.7,4.8,2c0.6,0.6,1.1,1.4,1.4,2.2c0.3,0.8,0.5,1.7,0.5,2.6c0,0.9-0.2,1.8-0.5,2.6
				c-0.3,0.8-0.8,1.5-1.4,2.1c-0.7,0.6-1.4,1.1-2.2,1.5c-0.8,0.3-1.7,0.5-2.6,0.5S5,13.3,4.2,12.9c-0.8-0.3-1.5-0.8-2.2-1.5
				s-1.1-1.4-1.5-2.2S0,7.6,0,6.7C0,5.8,0.2,5,0.5,4.2S1.3,2.6,2,2C3.3,0.7,4.8,0,6.7,0z M6.7,1.2c-1.5,0-2.8,0.5-3.9,1.6
				C2.3,3.4,1.9,4,1.6,4.6C1.4,5.3,1.2,6,1.2,6.7c0,0.7,0.1,1.4,0.4,2.1c0.3,0.7,0.7,1.3,1.2,1.8c0.5,0.5,1.1,0.9,1.8,1.2
				c0.7,0.3,1.4,0.4,2.1,0.4c0.7,0,1.4-0.1,2.1-0.4c0.7-0.3,1.3-0.7,1.8-1.2c1-1,1.6-2.3,1.6-3.9c0-0.7-0.1-1.4-0.4-2.1
				c-0.3-0.7-0.7-1.3-1.2-1.8C9.5,1.8,8.2,1.2,6.7,1.2z M6.6,5.6L5.7,6.1C5.6,5.9,5.5,5.7,5.4,5.6C5.3,5.6,5.1,5.5,5,5.5
				c-0.6,0-0.9,0.4-0.9,1.2c0,0.4,0.1,0.6,0.2,0.9C4.5,7.8,4.7,7.9,5,7.9c0.4,0,0.7-0.2,0.8-0.6l0.8,0.4C6.5,8.1,6.2,8.3,5.9,8.5
				c-0.3,0.2-0.7,0.3-1,0.3c-0.6,0-1.1-0.2-1.5-0.6C3.1,7.9,2.9,7.4,2.9,6.7c0-0.6,0.2-1.1,0.6-1.5c0.4-0.4,0.8-0.6,1.4-0.6
				C5.7,4.6,6.3,5,6.6,5.6z M10.5,5.6L9.6,6.1C9.5,5.9,9.4,5.7,9.3,5.6C9.1,5.6,9,5.5,8.9,5.5C8.3,5.5,8,5.9,8,6.7
				c0,0.4,0.1,0.6,0.2,0.9c0.2,0.2,0.4,0.3,0.7,0.3c0.4,0,0.7-0.2,0.8-0.6l0.8,0.4c-0.2,0.3-0.4,0.6-0.7,0.8c-0.3,0.2-0.7,0.3-1,0.3
				c-0.6,0-1.1-0.2-1.5-0.6C7,7.9,6.8,7.4,6.8,6.7c0-0.6,0.2-1.1,0.6-1.5c0.4-0.4,0.8-0.6,1.4-0.6C9.6,4.6,10.2,5,10.5,5.6z"/>
				</g>

				</g>
			</svg>
		</a>
		
		<a href='https://creativecommons.org/licenses/by-sa/4.0/'>Content:
		CC-BY-SA </a>
		
	</div>

</div>

    </div>
	      
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="library-overview">Library Overview</h1>

<blockquote>
<p><img src="../images/under-construction.png" alt="Under Construction" /></p>
</blockquote>

<aside class="warning">
This documentation is for a beta release of sdk2. If you have any issues please contact support or your sales representative.
</aside>

<p>The Python library wraps the Bonsai API to simplify the process of building simulators
in C++ and Python programming languages. The Python library is generated from the C++
library so for this beta version of documentation you may see some naming inconsistencies.
This library is compatible with Python 3+ only with MacOS and Linux operating systems.
Windows support will be available for the public release.</p>

<p>When the AI Engine trains with the simulator it works in a loop. First, the
simulator connects and registers itself with the AI Engine. Then, the simulator
sends the AI Engine a state and the value of any objectives or rewards; next,
the AI Engine replies with an action. The simulator then uses this action to
advance the simulation and compute a new state. This &ldquo;send state, receive
action&rdquo; process is repeated until training stops.  At any time the AI engine
may stop, reconfigure, and reset the simulator.  After doing so it will either
restart this training loop or stop training.  A single state, action, next state,
loop is sometimes referred to as an &ldquo;iteration&rdquo;.</p>

          <h1 id="brain-class">Brain Class</h1>

<p>Used to manage a BRAIN instance and talk with the server backend. Contains
state information about the BRAIN and can be used to upload/download inkling
to and from the BRAIN on the server.</p>

<p>Requires a shared pointer to a <code class="prettyprint">bonsai::Config</code> and a BRAIN name.</p>

<h2 id="brain-config-name">Brain(config, name)</h2>

<p>Construct a BRAIN using an existing configuration and BRAIN name.</p>

<ul>
<li><code class="prettyprint">config</code> Shared pointer to previously created <code class="prettyprint">bonsai::Config</code>.</li>
<li><code class="prettyprint">name</code>   BRAIN name as specified on the server. If name is empty the
        BRAIN name in <code class="prettyprint">config</code> will be used instead.</li>
</ul>

<h2 id="setup">setup()</h2>

<p>Checks the <code class="prettyprint">config()</code> and starts up a BRAIN for training if running in training mode.
Stops a BRAIN running for training mode if requested for prediction and the version is the latest.</p>

<h2 id="update">update()</h2>

<p>Retrieves current state information about the BRAIN from the server</p>

<h2 id="bool-ready">bool ready()</h2>

<p>Returns true if the BRAIN is ready to run for training or prediction.
A BRAIN may not be ready if it has no uploaded inkling files or is configured incorrectly.</p>

<h2 id="start">start()</h2>

<p>Instructs the server to start training for this BRAIN.</p>

<h2 id="stop">stop()</h2>

<p>Instructs the server to stop training for this BRAIN.</p>

<h2 id="string-name">string name()</h2>

<p>Returns the name of the BRAIN as specified when it was created.</p>

<h2 id="string-description">string description()</h2>

<p>Returns the user created description for the BRAIN.</p>

<h2 id="int-version">int version()</h2>

<p>Returns version number of the BRAIN</p>

<h2 id="config-config">Config config()</h2>

<p>Configuration used to talk to this BRAIN.</p>

          <h1 id="config-class">Config Class</h1>

<p>Used to manage bonsai configuration environments.
Config files can be either specified in the users home directory
or in a local directory. In addition, configuration parameters can be parsed from
the command line.</p>

<p>Example <code class="prettyprint">~/.bonsai</code> config file:</p>
<pre class="highlight ini tab-ini"><code><span class="nn">[DEFAULT]</span>
<span class="py">username</span> <span class="p">=</span> <span class="s">admin</span>
<span class="py">accesskey</span> <span class="p">=</span> <span class="s">None</span>
<span class="py">profile</span> <span class="p">=</span> <span class="s">dev</span>

<span class="nn">[dev]</span>
<span class="py">url</span> <span class="p">=</span> <span class="s">http://localhost:5000</span>
<span class="py">username</span> <span class="p">=</span> <span class="s">admin</span>
<span class="py">accesskey</span> <span class="p">=</span> <span class="s">00000000-1111-2222-3333-000000000001</span>

<span class="nn">[alpha]</span>
<span class="py">url</span> <span class="p">=</span> <span class="s">https://alpha-api.int.bons.ai</span>
<span class="py">username</span> <span class="p">=</span> <span class="s">mikest</span>
</code></pre>
<p>The <code class="prettyprint">profile</code> key can be used to switch between different profiles in
the same configuration file.</p>

<h2 id="config-profile">Config(profile)</h2>

<p>Constructs a default configuration.
- <code class="prettyprint">profile</code> Name of the default profile. Default value is an empty string.</p>

<p>Configurations are stored in <code class="prettyprint">~/.bonsai</code> and <code class="prettyprint">./.bonsai</code> configuration files.
The local configuration file will override settings in the users home directory configuration file.</p>
<pre class="highlight python tab-python"><code><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">auto</span> <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">config</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<h2 id="config-argc-argv-profile">Config(argc, argv, profile)</h2>

<p>Constructs a config by looking in the configuration files and parsing the command line arguments.
In Python, <code class="prettyprint">argc</code> is not necessary.</p>

<p>Arguments:</p>

<ul>
<li><code class="prettyprint">argc</code> &hellip;as passed to <code class="prettyprint">int main(int argc, char** argv)</code>.</li>
<li><code class="prettyprint">argv</code> &hellip;same.</li>
<li><code class="prettyprint">profile</code> Name of the default profile.</li>
</ul>

<p>Example command line arguments:</p>

<ul>
<li><code class="prettyprint">--accesskey=00000000-1111-2222-3333-000000000001</code></li>
<li><code class="prettyprint">--username=admin</code></li>
<li><code class="prettyprint">--url=http://localhost:32802</code></li>
</ul>

<p>Unrecognized arguments will be ignored.</p>

<h2 id="accesskey">accesskey()</h2>

<p>Server authentication token.
Obtained from the bonsai server. you will need to set it in your config.</p>

<h2 id="username">username()</h2>

<p>Account user name.
The account you signed up with.</p>

<h2 id="url">url()</h2>

<p>Server URL.
Address and port number of the bonsai server. Normally you should not need to change this.</p>

<h2 id="proxy">proxy()</h2>

<p>Proxy Server.
Address and port number of the proxy server to connect through.</p>

<h2 id="brain">brain()</h2>

<p>BRAIN name.
Name of the BRAIN on the server.</p>

<h2 id="predict">predict()</h2>

<p>Simulator mode.
The mode simulators will run in, true if running for prediction, false for training.</p>

<h2 id="brain_version">brain_version()</h2>

<p>Brain version.
The version of the brain to use when running for prediction. Set to 0 to use latest version</p>

<h2 id="recording_file">recording_file()</h2>

<p>Simulator log file path.
Path to a file to use for simulator logging. If you are implementing a simulator this may
be used to specify a log file in a simulator specific nature. Implementation is left as an
exercise to the simulator.</p>

          <h1 id="simulator-class">Simulator Class</h1>

<blockquote>
<p><img src="../images/simulator_state.svg" alt="Simulator state image" /></p>
</blockquote>

<p>This class is used to interface with the server while training or running predictions against
a <strong>BRAIN</strong>. It is an abstract base class, and the developer must create a subclass.</p>

<p>The <code class="prettyprint">Simulator</code> class has a close relationship with the <strong>Inkling</strong> file associated with
the <strong>BRAIN</strong>. The name used to construct the <code class="prettyprint">Simulator</code> must match the name of the simulator
in the <em>Inkling</em> file.</p>

<p>There are two main methods one must override, <code class="prettyprint">episode_start</code> and <code class="prettyprint">simulate</code>.</p>

<h2 id="brain-brain">Brain brain()</h2>

<p>Returns the brain being used for this simulation.</p>

<h2 id="string-name">string name()</h2>

<p>Returns the simulator name that was passed in when constructed</p>

<h2 id="bool-predict">bool predict()</h2>

<p>Returns weather or not the simulation is setup to run in predict or training mode</p>

<h2 id="string-objective_name">string objective_name()</h2>

<p>Accessor method which returns the name of the current objective.
Objective may be updated before <code class="prettyprint">episode_start</code> is called. When running
for prediction and during start up, objective will return an empty string.</p>

<h2 id="episode_start-parameters-initial_state">episode_start(parameters, initial_state)</h2>

<h3 id="arguments">Arguments</h3>

<ul>
<li><code class="prettyprint">parameters</code>     InklingMessage of initialization parameters for an episode as defined in
               inkling. <code class="prettyprint">parameters</code> Will be populated if a training session is running.</li>
<li><code class="prettyprint">initial_state</code>  Output InklingMessage. The subclasser should populate this message with the
               initial state of the simulation.</li>
</ul>

<blockquote>
<p>Example Inkling:</p>
</blockquote>
<pre class="highlight inkling tab-inkling"><code><span class="k">schema</span> <span class="nx">Config</span>
    <span class="kr">UInt8</span> <span class="nx">start_angle</span>
<span class="k">end</span>

<span class="k">schema</span> <span class="nx">State</span>
    <span class="kr">Float32</span> <span class="nx">angle</span><span class="p">,</span>
    <span class="kr">Float32</span> <span class="nx">velocity</span>
<span class="k">end</span>
</code></pre>
<blockquote>
<p>Example code:</p>
</blockquote>
<pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">MySimulator</span><span class="o">::</span><span class="n">episode_start</span><span class="p">(</span><span class="k">const</span> <span class="n">InklingMessage</span><span class="o">&amp;</span> <span class="n">params</span><span class="p">,</span> <span class="n">InklingMessage</span><span class="o">&amp;</span> <span class="n">initial_state</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">objective_name</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">params</span><span class="p">.</span><span class="n">get_float32</span><span class="p">(</span><span class="s">"start_angle"</span><span class="p">);</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">set_float32</span><span class="p">(</span><span class="s">"velocity"</span><span class="p">,</span> <span class="n">velocity</span><span class="p">);</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">set_float32</span><span class="p">(</span><span class="s">"angle"</span><span class="p">,</span>    <span class="n">angle</span><span class="p">);</span>
<span class="p">}</span>
</code></pre><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">episode_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">start_angle</span>
    <span class="n">initial</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"angle"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span>
        <span class="s">"velocity"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">initial</span>
</code></pre>
<p>This callback passes in a set of initial parameters and expects an initial state in return
for the simulator. Before this callback is called, the property <code class="prettyprint">objective_name</code> will be
updated to reflect the current objective for this episode.</p>

<p>This call is where a simulation should be reset for the next round.</p>

<h2 id="simulate-action-state-terminal">simulate(action, state, terminal)</h2>

<h3 id="arguments">Arguments</h3>

<ul>
<li><code class="prettyprint">action</code>   Input InklingMessage of action to be taken as defined in inkling.</li>
<li><code class="prettyprint">state</code>    Output InklingMessage. Should be populated with the current simulator state.</li>
<li><code class="prettyprint">reward</code>   Output reward value as calculated based upon the objective.</li>
<li><code class="prettyprint">terminal</code> Output terminal state. Set to true if the simulator is in a terminal state.</li>
</ul>

<blockquote>
<p>Example Inkling:</p>
</blockquote>
<pre class="highlight inkling tab-inkling"><code><span class="k">schema</span> <span class="nx">Action</span>
    <span class="kr">Int8</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">}</span> <span class="nx">delta</span>
<span class="k">end</span>
</code></pre>
<blockquote>
<p>Example code:</p>
</blockquote>
<pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
    <span class="n">velocity</span> <span class="o">=</span> <span class="n">velocity</span> <span class="o">-</span> <span class="n">action</span><span class="o">.</span><span class="n">delta</span><span class="p">;</span>
    <span class="n">terminal</span> <span class="o">=</span> <span class="p">(</span><span class="n">velocity</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">reward</span> <span class="o">=</span> <span class="n">reward_for_objective</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_name</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"velocity"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">,</span>
        <span class="s">"angle"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminal</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="kt">void</span> <span class="n">Test</span><span class="o">::</span><span class="n">simulate</span><span class="p">(</span><span class="k">const</span> <span class="n">InklingMessage</span><span class="o">&amp;</span> <span class="n">action</span><span class="p">,</span>
    <span class="n">InklingMessage</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="kt">float</span><span class="o">&amp;</span> <span class="n">reward</span><span class="p">,</span> <span class="kt">bool</span><span class="o">&amp;</span> <span class="n">terminal</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">velocity</span> <span class="o">=</span> <span class="n">velocity</span> <span class="o">-</span> <span class="n">action</span><span class="p">.</span><span class="n">get_int8</span><span class="p">(</span><span class="s">"delta"</span><span class="p">);</span>
    <span class="n">terminal</span> <span class="o">=</span> <span class="p">(</span><span class="n">velocity</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">reward</span> <span class="o">=</span> <span class="n">reward_for_objective</span><span class="p">(</span><span class="n">objective_name</span><span class="p">());</span>
    <span class="n">state</span><span class="p">.</span><span class="n">set_float32</span><span class="p">(</span><span class="s">"velocity"</span><span class="p">,</span> <span class="n">velocity</span><span class="p">);</span>
    <span class="n">state</span><span class="p">.</span><span class="n">set_float32</span><span class="p">(</span><span class="s">"angle"</span><span class="p">,</span>    <span class="n">angle</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
<p>This callback is used to step the simulation forward by a single step. It passes in
the <code class="prettyprint">action</code> to be taken, and expects the resulting <code class="prettyprint">state</code>, <code class="prettyprint">reward</code> for the current
<code class="prettyprint">objective</code>, and a <code class="prettyprint">terminal</code> flag used to signal the end of an episode. Note that an
episode may be reset prematurely by the backend during training.</p>

<p>For multi-lesson curriculum the <code class="prettyprint">objective_name</code> will change from episode to episode.
The simulator should take care to insure that it is returning the correct reward for the
different lessons.</p>

<p>Returning <code class="prettyprint">true</code> for the <code class="prettyprint">terminal</code> flag will signal the start of a new episode.</p>

<h2 id="bool-standby-reason">bool standby(reason)</h2>

<h3 id="arguments">Arguments</h3>

<ul>
<li><code class="prettyprint">reason</code>  A string describing the reason training has been delayed</li>
</ul>

<p>The default action is to wait one second and continue. If returns <code class="prettyprint">true</code>,
the server status will be checked again and the loop will continue.</p>

<p>bool run()</p>
<pre class="highlight python tab-python"><code><span class="n">mySim</span> <span class="o">=</span> <span class="n">MySimulator</span><span class="p">(</span><span class="n">brain</span><span class="p">)</span>
<span class="k">while</span> <span class="n">mySim</span><span class="o">.</span><span class="n">run</span><span class="p">():</span>
    <span class="k">continue</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">MySimulator</span> <span class="n">mySim</span><span class="p">(</span><span class="n">brain</span><span class="p">);</span>
<span class="k">while</span><span class="p">(</span> <span class="n">mySim</span><span class="p">.</span><span class="n">run</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">continue</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p>Main loop call for driving the simulation. Will return <code class="prettyprint">false</code> when the
simulation has finished or halted.</p>

<p>The client should call this method in a <code class="prettyprint">while</code> loop until it returns <code class="prettyprint">false</code>.
To run for prediction <code class="prettyprint">brain()-&gt;config()-&gt;predict()</code> must return <code class="prettyprint">true</code>.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="cpp">cpp</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>

    </div>

  </div>
  <!-- at the end of the BODY -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
  <script type="text/javascript"> docsearch({
  apiKey: '49fa6f01d7ff94a85b9b7434b1c2b7cf',
  indexName: 'bon-sai',
  inputSelector: '#docs-search',
  debug: false // Set debug to true if you want to inspect the dropdown
  });
  </script>
  </body>
</html>
